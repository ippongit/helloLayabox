var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**This class is automatically generated by LayaAirIDE, please do not make any modifications. */

var GameConfig = function () {
    function GameConfig() {
        _classCallCheck(this, GameConfig);
    }

    _createClass(GameConfig, null, [{
        key: "init",
        value: function init() {
            //注册Script或者Runtime引用
            var reg = Laya.ClassUtils.regClass;
        }
    }]);

    return GameConfig;
}();

exports.default = GameConfig;

GameConfig.width = 1280;
GameConfig.height = 720;
GameConfig.scaleMode = "showall";
GameConfig.screenMode = "horizontal";
GameConfig.alignV = "top";
GameConfig.alignH = "left";
GameConfig.startScene = "RankTest.scene";
GameConfig.sceneRoot = "";
GameConfig.debug = false;
GameConfig.stat = false;
GameConfig.physicsDebug = false;
GameConfig.exportSceneToJson = true;

GameConfig.init();

},{}],2:[function(require,module,exports){
"use strict";

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**Main.js*/


var _GameConfig = require("./GameConfig");

var _GameConfig2 = _interopRequireDefault(_GameConfig);

var _layaMaxUI = require("./ui/layaMaxUI");

var _layaMaxUI2 = _interopRequireDefault(_layaMaxUI);

var _Rank = require("./script/Rank");

var _Rank2 = _interopRequireDefault(_Rank);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Main = function () {
	function Main() {
		_classCallCheck(this, Main);

		Laya.isWXOpenDataContext = true;
		//根据IDE设置初始化引擎	
		Laya.init(_GameConfig2.default.width, _GameConfig2.default.height);

		Laya["DebugPanel"] && Laya["DebugPanel"].enable();
		Laya.stage.scaleMode = _GameConfig2.default.scaleMode;
		Laya.stage.screenMode = _GameConfig2.default.screenMode;
		Laya.stage.alignV = _GameConfig2.default.alignV;
		Laya.stage.alignH = _GameConfig2.default.alignH;
		//兼容微信不支持加载scene后缀场景
		Laya.URL.exportSceneToJson = _GameConfig2.default.exportSceneToJson;

		this.onConfigLoaded();
	}

	_createClass(Main, [{
		key: "onConfigLoaded",
		value: function onConfigLoaded() {
			wx.onMessage(function (message) {
				switch (message.type) {
					case "show":
						{
							console.log("显示信息： ", message);
							if (this.rank) return;
							this.rank = new _Rank2.default();
							Laya.stage.addChild(this.rank);
							this.rank.submitUserDate(message.bestScore);
						}break;
					case "close":
						{
							if (this.rank) {
								this.rank.destroy(true);
								this.rank = null;
							}
						}break;
				}
			});
		}
	}]);

	return Main;
}();
//激活启动类


new Main();

},{"./GameConfig":1,"./script/Rank":3,"./ui/layaMaxUI":4}],3:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

/**Rank.js */
var Rank = function (_ui$RankUI) {
    _inherits(Rank, _ui$RankUI);

    function Rank() {
        _classCallCheck(this, Rank);

        return _possibleConstructorReturn(this, (Rank.__proto__ || Object.getPrototypeOf(Rank)).call(this));
    }

    _createClass(Rank, [{
        key: "onEnable",
        value: function onEnable() {
            this.list = this.getChildByName('list');
            var arr = [];
            this.list.array = arr;
        }

        /**
         *写入玩家数据
         */

    }, {
        key: "submitUserDate",
        value: function submitUserDate(bestScore) {
            console.log("开放域写入数据", bestScore);
            var self = this;
            //KVDataList代表排行数据,可以为多个,多个代表多个排行
            //key-排行类型,value-排行分数
            var KVDataList = new Array();
            //value 只能是字符串！！！
            KVDataList.push({
                key: "bestScore",
                value: bestScore.toString()
            });

            wx.setUserCloudStorage({
                KVDataList: KVDataList,
                success: function success(res) {
                    console.log('setUserCloudStorage', 'success', res);
                    self.selectRanking();
                },
                fail: function fail(res) {
                    console.log('setUserCloudStorage', 'fail');
                }
            });
        }

        /**
         * 拉取排行
         */

    }, {
        key: "selectRanking",
        value: function selectRanking() {
            console.log("开始获取排行");
            //openIdList: ['selfOpenId']-代表获取个人数据
            //wx.getFriendCloudStorage获取好友数据(包括自己),所以用avatarUrl头像路径可分辨是否是自己
            //keyList-获取的排行类型,填入几个可以获得几个类别排行

            var self = this;
            wx.getUserInfo({
                openIdList: ['selfOpenId'],
                success: function success(userRes) {
                    //this.loadingLabel.active = false;
                    console.log('拉取排行中的个人信息', userRes.data);
                    //索引代表各个好友0为自己
                    var userData = userRes.data[0];
                    console.log("排行中的个人名字" + userData.nickName);
                    //取出所有好友数据
                    wx.getFriendCloudStorage({
                        keyList: ['bestScore'],
                        success: function success(res) {
                            console.log("wx.getFriendCloudStorage success", res);
                            var data = res.data;
                            data.sort(function (a, b) {
                                if (a.KVDataList.length == 0 && b.KVDataList.length == 0) {
                                    return 0;
                                }
                                if (a.KVDataList.length == 0) {
                                    return 1;
                                }
                                if (b.KVDataList.length == 0) {
                                    return -1;
                                }
                                return b.KVDataList[0].value - a.KVDataList[0].value;
                            });
                            var selfIndex = 0;
                            for (var i = 0; i < data.length; i++) {
                                var playerInfo = data[i];
                                //判断 data[i].nickname === userData,nickName 可能有相同昵称
                                if (data[i].avatarUrl == userData.avatarUrl) {
                                    console.log('此ID为自己');
                                    selfIndex = i;
                                }
                            }

                            for (var i = 0; i < data.length; i++) {
                                console.log('data[' + i + ']: ', data[i]);
                            }

                            self.setRankingDate(data, selfIndex);
                        },
                        fail: function fail(res) {
                            console.log("拉取好友信息失败", res);
                        }
                    });
                },
                fail: function fail(res) {
                    console.log("拉取个人信息失败");
                }
            });
        }

        /**
         * 设置排行界面显示数据
         */

    }, {
        key: "setRankingDate",
        value: function setRankingDate(usersData, selfIndex) {
            console.log("拿到data信息", usersData);
            console.log("长度", usersData.length);
            var arr = [];

            var data_length = usersData.length;
            if (data_length > 5) data_length = 5; //只显示前五名

            for (var i = 0; i < data_length; i++) {
                var user = usersData[i];
                //wxAPI中定义的nickname全部小写
                arr.push({ nickName: user.nickname, avatarUrl: user.avatarUrl, KVDataList: user.KVDataList });
            }

            console.log('数据准备完毕 \n', arr);
            //刷新排行榜
            this.update(arr);
        }
    }, {
        key: "update",
        value: function update(arr) {
            if (arr === undefined) return;
            this.list.array = arr;
            this.list.renderHandler = new Laya.Handler(this, this.onRender);
        }
    }, {
        key: "onRender",
        value: function onRender(cell, index) {
            //获取当前渲染条目的数据
            var data = this.list.array[index];
            console.log("个人信息", data);
            var ranking = cell.getChildByName("ranking");
            ranking.text = index + 1;
            //根据子节点的名字name，获取子节点对象。         
            var name = cell.getChildByName("nickName");
            //label渲染列表文本（序号）
            name.text = data.nickName;
            var bestScore = cell.getChildByName("bestScore");
            bestScore.text = data.KVDataList[0].value;
            // var iconBG = cell.getChildByName("iconBG");
            var icon = cell.getChildByName("icon");
            //图片大小要与编辑器内一致,坐标为00,
            icon.loadImage(data.avatarUrl, 0, 0, 60, 60);
            console.log("排行数据=", index, '=刷新完成!~~');
        }
    }]);

    return Rank;
}(ui.RankUI);

exports.default = Rank;

},{}],4:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});
/**This class is automatically generated by LayaAirIDE, please do not make any modifications. */
var CLASS$ = Laya.class;
var STATICATTR$ = Laya.static;
var View = laya.ui.View;
var Dialog = laya.ui.Dialog;
var Scene = Laya.Scene;
if (!window.ui) window.ui = {};
var RankUI = function (_super) {
	function RankUI() {

		RankUI.__super.call(this);
	}
	CLASS$(RankUI, 'ui.RankUI', _super);
	var __proto__ = RankUI.prototype;
	__proto__.createChildren = function () {
		_super.prototype.createChildren.call(this);
		this.createView(RankUI.uiView);
	};
	RankUI.uiView = { "type": "View", "props": { "width": 600, "height": 600 }, "compId": 2, "child": [{ "type": "List", "props": { "width": 600, "name": "list", "height": 400 }, "compId": 3, "child": [{ "type": "Box", "props": { "width": 600, "renderType": "render", "name": "item", "height": 80 }, "compId": 4, "child": [{ "type": "Image", "props": { "y": 0, "x": 0, "width": 600, "skin": "img/panelBK.png", "sizeGrid": "20,20,20,20", "name": "bk", "height": 80 }, "compId": 6 }, { "type": "Label", "props": { "y": 15, "x": 5, "width": 60, "text": "0", "name": "ranking", "height": 60, "fontSize": 48, "color": "#000000", "bold": true, "anchorY": 0, "anchorX": 0, "align": "center" }, "compId": 7 }, { "type": "Image", "props": { "y": 12, "x": 63, "width": 60, "name": "icon", "height": 60 }, "compId": 8 }, { "type": "Label", "props": { "y": 25, "x": 135, "width": 200, "text": "nickName", "name": "nickName", "height": 40, "fontSize": 32, "color": "#000000", "align": "left" }, "compId": 9 }, { "type": "Label", "props": { "y": 25, "x": 360, "width": 200, "text": "1234567890", "name": "bestScore", "height": 40, "fontSize": 32, "color": "#000000", "anchorY": 0, "anchorX": 0, "align": "left" }, "compId": 10 }] }] }], "loadList": ["img/panelBK.png"], "loadList3D": [] };
	return RankUI;
}(View);
exports.default = ui;

},{}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL0xheWFBaXJJREVfMi4wMWJldGEvcmVzb3VyY2VzL2FwcC9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwic3JjL0dhbWVDb25maWcuanMiLCJzcmMvTWFpbi5qcyIsInNyYy9zY3JpcHQvUmFuay5qcyIsInNyYy91aS9sYXlhTWF4VUkuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUNWQTs7SUFHcUIsVTs7Ozs7OzsrQkFDSDtBQUNWO0FBQ0EsZ0JBQUksTUFBTSxLQUFLLFVBQUwsQ0FBZ0IsUUFBMUI7QUFFSDs7Ozs7O2tCQUxnQixVOztBQU9yQixXQUFXLEtBQVgsR0FBbUIsSUFBbkI7QUFDQSxXQUFXLE1BQVgsR0FBb0IsR0FBcEI7QUFDQSxXQUFXLFNBQVgsR0FBc0IsU0FBdEI7QUFDQSxXQUFXLFVBQVgsR0FBd0IsWUFBeEI7QUFDQSxXQUFXLE1BQVgsR0FBb0IsS0FBcEI7QUFDQSxXQUFXLE1BQVgsR0FBb0IsTUFBcEI7QUFDQSxXQUFXLFVBQVgsR0FBd0IsZ0JBQXhCO0FBQ0EsV0FBVyxTQUFYLEdBQXVCLEVBQXZCO0FBQ0EsV0FBVyxLQUFYLEdBQW1CLEtBQW5CO0FBQ0EsV0FBVyxJQUFYLEdBQWtCLEtBQWxCO0FBQ0EsV0FBVyxZQUFYLEdBQTBCLEtBQTFCO0FBQ0EsV0FBVyxpQkFBWCxHQUErQixJQUEvQjs7QUFFQSxXQUFXLElBQVg7Ozs7O3FqQkN2QkM7OztBQUNEOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7SUFDTSxJO0FBQ0wsaUJBQWM7QUFBQTs7QUFDYixPQUFLLG1CQUFMLEdBQTJCLElBQTNCO0FBQ0E7QUFDQSxPQUFLLElBQUwsQ0FBVSxxQkFBVyxLQUFyQixFQUE0QixxQkFBVyxNQUF2Qzs7QUFFQSxPQUFLLFlBQUwsS0FBc0IsS0FBSyxZQUFMLEVBQW1CLE1BQW5CLEVB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dEYsRUFBcFUsRUFBNlosRUFBQyxRQUFPLE9BQVIsRUFBZ0IsU0FBUSxFQUFDLEtBQUksRUFBTCxFQUFRLEtBQUksR0FBWixFQUFnQixTQUFRLEdBQXhCLEVBQTRCLFFBQU8sVUFBbkMsRUFBOEMsUUFBTyxVQUFyRCxFQUFnRSxVQUFTLEVBQXpFLEVBQTRFLFlBQVcsRUFBdkYsRUFBMEYsU0FBUSxTQUFsRyxFQUE0RyxTQUFRLE1BQXBILEVBQXhCLEVBQW9KLFVBQVMsQ0FBN0osRUFBN1osRUFBNmpCLEVBQUMsUUFBTyxPQUFSLEVBQWdCLFNBQVEsRUFBQyxLQUFJLEVBQUwsRUFBUSxLQUFJLEdBQVosRUFBZ0IsU0FBUSxHQUF4QixFQUE0QixRQUFPLFlBQW5DLEVBQWdELFFBQU8sV0FBdkQsRUFBbUUsVUFBUyxFQUE1RSxFQUErRSxZQUFXLEVBQTFGLEVBQTZGLFNBQVEsU0FBckcsRUFBK0csV0FBVSxDQUF6SCxFQUEySCxXQUFVLENBQXJJLEVBQXVJLFNBQVEsTUFBL0ksRUFBeEIsRUFBK0ssVUFBUyxFQUF4TCxFQUE3akIsQ0FBdkcsRUFBRCxDQUFuRixFQUFELENBQXJFLEVBQSsvQixZQUFXLENBQUMsaUJBQUQsQ0FBMWdDLEVBQThoQyxjQUFhLEVBQTNpQyxFQUFkO0FBQ0EsUUFBTyxNQUFQO0FBQ0EsQ0FiUyxDQWFQLElBYk8sQ0FBWDtRQWNjLE8sR0FBTixFIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qKlRoaXMgY2xhc3MgaXMgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTGF5YUFpcklERSwgcGxlYXNlIGRvIG5vdCBtYWtlIGFueSBtb2RpZmljYXRpb25zLiAqL1xyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWVDb25maWcge1xyXG4gICAgc3RhdGljIGluaXQoKSB7XHJcbiAgICAgICAgLy/ms6jlhoxTY3JpcHTmiJbogIVSdW50aW1l5byV55SoXHJcbiAgICAgICAgbGV0IHJlZyA9IExheWEuQ2xhc3NVdGlscy5yZWdDbGFzcztcclxuXHJcbiAgICB9XHJcbn1cclxuR2FtZUNvbmZpZy53aWR0aCA9IDEyODA7XHJcbkdhbWVDb25maWcuaGVpZ2h0ID0gNzIwO1xyXG5HYW1lQ29uZmlnLnNjYWxlTW9kZSA9XCJzaG93YWxsXCI7XHJcbkdhbWVDb25maWcuc2NyZWVuTW9kZSA9IFwiaG9yaXpvbnRhbFwiO1xyXG5HYW1lQ29uZmlnLmFsaWduViA9IFwidG9wXCI7XHJcbkdhbWVDb25maWcuYWxpZ25IID0gXCJsZWZ0XCI7XHJcbkdhbWVDb25maWcuc3RhcnRTY2VuZSA9IFwiUmFua1Rlc3Quc2NlbmVcIjtcclxuR2FtZUNvbmZpZy5zY2VuZVJvb3QgPSBcIlwiO1xyXG5HYW1lQ29uZmlnLmRlYnVnID0gZmFsc2U7XHJcbkdhbWVDb25maWcuc3RhdCA9IGZhbHNlO1xyXG5HYW1lQ29uZmlnLnBoeXNpY3NEZWJ1ZyA9IGZhbHNlO1xyXG5HYW1lQ29uZmlnLmV4cG9ydFNjZW5lVG9Kc29uID0gdHJ1ZTtcclxuXHJcbkdhbWVDb25maWcuaW5pdCgpO1xyXG4iLCLvu78vKipNYWluLmpzKi9cclxuaW1wb3J0IEdhbWVDb25maWcgZnJvbSBcIi4vR2FtZUNvbmZpZ1wiO1xyXG5pbXBvcnQgdWkgZnJvbSBcIi4vdWkvbGF5YU1heFVJXCI7XHJcbmltcG9ydCBSYW5rIGZyb20gXCIuL3NjcmlwdC9SYW5rXCI7XHJcbmNsYXNzIE1haW4ge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0TGF5YS5pc1dYT3BlbkRhdGFDb250ZXh0ID0gdHJ1ZTtcclxuXHRcdC8v5qC55o2uSURF6K6+572u5Yid5aeL5YyW5byV5pOOXHRcclxuXHRcdExheWEuaW5pdChHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCk7XHJcblxyXG5cdFx0TGF5YVtcIkRlYnVnUGFuZWxcIl0gJiYgTGF5YVtcIkRlYnVnUGFuZWxcIl0uZW5hYmxlKCk7XHJcblx0XHRMYXlhLnN0YWdlLnNjYWxlTW9kZSA9IEdhbWVDb25maWcuc2NhbGVNb2RlO1xyXG5cdFx0TGF5YS5zdGFnZS5zY3JlZW5Nb2RlID0gR2FtZUNvbmZpZy5zY3JlZW5Nb2RlO1xyXG5cdFx0TGF5YS5zdGFnZS5hbGlnblYgPSBHYW1lQ29uZmlnLmFsaWduVjtcclxuXHRcdExheWEuc3RhZ2UuYWxpZ25IID0gR2FtZUNvbmZpZy5hbGlnbkg7XHJcblx0XHQvL+WFvOWuueW+ruS/oeS4jeaUr+aMgeWKoOi9vXNjZW5l5ZCO57yA5Zy65pmvXHJcblx0XHRMYXlhLlVSTC5leHBvcnRTY2VuZVRvSnNvbiA9IEdhbWVDb25maWcuZXhwb3J0U2NlbmVUb0pzb247XHJcblxyXG5cdFx0dGhpcy5vbkNvbmZpZ0xvYWRlZCgpO1xyXG5cdH1cclxuXHJcblx0b25Db25maWdMb2FkZWQoKSB7XHJcblx0XHR3eC5vbk1lc3NhZ2UoZnVuY3Rpb24gKG1lc3NhZ2UpIHtcclxuXHRcdFx0c3dpdGNoIChtZXNzYWdlLnR5cGUpIHtcclxuXHRcdFx0XHRjYXNlIFwic2hvd1wiOiB7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIuaYvuekuuS/oeaBr++8miBcIiwgbWVzc2FnZSk7XHJcblx0XHRcdFx0XHRpZiAodGhpcy5yYW5rKSByZXR1cm47XHJcblx0XHRcdFx0XHR0aGlzLnJhbmsgPSBuZXcgUmFuaygpO1xyXG5cdFx0XHRcdFx0TGF5YS5zdGFnZS5hZGRDaGlsZCh0aGlzLnJhbmspO1xyXG5cdFx0XHRcdFx0dGhpcy5yYW5rLnN1Ym1pdFVzZXJEYXRlKG1lc3NhZ2UuYmVzdFNjb3JlKTtcclxuXHRcdFx0XHR9IGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJjbG9zZVwiOiB7XHJcblx0XHRcdFx0XHRpZiAodGhpcy5yYW5rKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMucmFuay5kZXN0cm95KHRydWUpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLnJhbmsgPSBudWxsO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gYnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufVxyXG4vL+a/gOa0u+WQr+WKqOexu1xyXG5uZXcgTWFpbigpO1xyXG4iLCIvKipSYW5rLmpzICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJhbmsgZXh0ZW5kcyB1aS5SYW5rVUkge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgIH1cclxuICAgIG9uRW5hYmxlKCkge1xyXG4gICAgICAgIHRoaXMubGlzdCA9IHRoaXMuZ2V0Q2hpbGRCeU5hbWUoJ2xpc3QnKTtcclxuICAgICAgICB2YXIgYXJyID0gW107XHJcbiAgICAgICAgdGhpcy5saXN0LmFycmF5ID0gYXJyO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICrlhpnlhaXnjqnlrrbmlbDmja5cclxuICAgICAqL1xyXG4gICAgc3VibWl0VXNlckRhdGUoYmVzdFNjb3JlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCLlvIDmlL7ln5/lhpnlhaXmlbDmja5cIiwgYmVzdFNjb3JlKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgLy9LVkRhdGFMaXN05Luj6KGo5o6S6KGM5pWw5o2uLOWPr+S7peS4uuWkmuS4qizlpJrkuKrku6PooajlpJrkuKrmjpLooYxcclxuICAgICAgICAvL2tleS3mjpLooYznsbvlnossdmFsdWUt5o6S6KGM5YiG5pWwXHJcbiAgICAgICAgdmFyIEtWRGF0YUxpc3QgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICAvL3ZhbHVlIOWPquiDveaYr+Wtl+espuS4su+8ge+8ge+8gVxyXG4gICAgICAgIEtWRGF0YUxpc3QucHVzaCh7XHJcbiAgICAgICAgICAgIGtleTogXCJiZXN0U2NvcmVcIixcclxuICAgICAgICAgICAgdmFsdWU6IGJlc3RTY29yZS50b1N0cmluZygpXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHd4LnNldFVzZXJDbG91ZFN0b3JhZ2Uoe1xyXG4gICAgICAgICAgICBLVkRhdGFMaXN0OiBLVkRhdGFMaXN0LFxyXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2V0VXNlckNsb3VkU3RvcmFnZScsICdzdWNjZXNzJywgcmVzKVxyXG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RSYW5raW5nKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZhaWw6IGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZXRVc2VyQ2xvdWRTdG9yYWdlJywgJ2ZhaWwnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmi4nlj5bmjpLooYxcclxuICAgICAqL1xyXG4gICAgc2VsZWN0UmFua2luZygpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIuW8gOWni+iOt+WPluaOkuihjFwiKTtcclxuICAgICAgICAvL29wZW5JZExpc3Q6IFsnc2VsZk9wZW5JZCddLeS7o+ihqOiOt+WPluS4quS6uuaVsOaNrlxyXG4gICAgICAgIC8vd3guZ2V0RnJpZW5kQ2xvdWRTdG9yYWdl6I635Y+W5aW95Y+L5pWw5o2uKOWMheaLrOiHquW3sSks5omA5Lul55SoYXZhdGFyVXJs5aS05YOP6Lev5b6E5Y+v5YiG6L6o5piv5ZCm5piv6Ieq5bexXHJcbiAgICAgICAgLy9rZXlMaXN0LeiOt+WPlueahOaOkuihjOexu+WeiyzloavlhaXlh6DkuKrlj6/ku6Xojrflvpflh6DkuKrnsbvliKvmjpLooYxcclxuXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHd4LmdldFVzZXJJbmZvKHtcclxuICAgICAgICAgICAgb3BlbklkTGlzdDogWydzZWxmT3BlbklkJ10sXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICh1c2VyUmVzKSB7XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMubG9hZGluZ0xhYmVsLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+aLieWPluaOkuihjOS4reeahOS4quS6uuS/oeaBrycsIHVzZXJSZXMuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAvL+e0ouW8leS7o+ihqOWQhOS4quWlveWPizDkuLroh6rlt7FcclxuICAgICAgICAgICAgICAgIHZhciB1c2VyRGF0YSA9IHVzZXJSZXMuZGF0YVswXTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5o6S6KGM5Lit55qE5Liq5Lq65ZCN5a2XXCIgKyB1c2VyRGF0YS5uaWNrTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAvL+WPluWHuuaJgOacieWlveWPi+aVsOaNrlxyXG4gICAgICAgICAgICAgICAgd3guZ2V0RnJpZW5kQ2xvdWRTdG9yYWdlKHtcclxuICAgICAgICAgICAgICAgICAgICBrZXlMaXN0OiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdiZXN0U2NvcmUnLFxyXG4gICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInd4LmdldEZyaWVuZENsb3VkU3RvcmFnZSBzdWNjZXNzXCIsIHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gcmVzLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEuS1ZEYXRhTGlzdC5sZW5ndGggPT0gMCAmJiBiLktWRGF0YUxpc3QubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhLktWRGF0YUxpc3QubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiLktWRGF0YUxpc3QubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYi5LVkRhdGFMaXN0WzBdLnZhbHVlIC0gYS5LVkRhdGFMaXN0WzBdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGZJbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXllckluZm8gPSBkYXRhW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/liKTmlq0gZGF0YVtpXS5uaWNrbmFtZSA9PT0gdXNlckRhdGEsbmlja05hbWUg5Y+v6IO95pyJ55u45ZCM5pi156ewXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVtpXS5hdmF0YXJVcmwgPT0gdXNlckRhdGEuYXZhdGFyVXJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+atpElE5Li66Ieq5bexJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZkluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZGF0YVsnICsgaSArICddOiAnLCBkYXRhW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRSYW5raW5nRGF0ZShkYXRhLCBzZWxmSW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZmFpbDogZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuaLieWPluWlveWPi+S/oeaBr+Wksei0pVwiLCByZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZmFpbDogZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLmi4nlj5bkuKrkurrkv6Hmga/lpLHotKVcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5o6S6KGM55WM6Z2i5pi+56S65pWw5o2uXHJcbiAgICAgKi9cclxuICAgIHNldFJhbmtpbmdEYXRlKHVzZXJzRGF0YSwgc2VsZkluZGV4KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCLmi7/liLBkYXRh5L+h5oGvXCIsIHVzZXJzRGF0YSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCLplb/luqZcIiwgdXNlcnNEYXRhLmxlbmd0aCk7XHJcbiAgICAgICAgdmFyIGFyciA9IFtdO1xyXG5cclxuICAgICAgICB2YXIgZGF0YV9sZW5ndGggPSB1c2Vyc0RhdGEubGVuZ3RoO1xyXG4gICAgICAgIGlmIChkYXRhX2xlbmd0aCA+IDUpIGRhdGFfbGVuZ3RoID0gNTsvL+WPquaYvuekuuWJjeS6lOWQjVxyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGFfbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHVzZXIgPSB1c2Vyc0RhdGFbaV07XHJcbiAgICAgICAgICAgIC8vd3hBUEnkuK3lrprkuYnnmoRuaWNrbmFtZeWFqOmDqOWwj+WGmVxyXG4gICAgICAgICAgICBhcnIucHVzaCh7IG5pY2tOYW1lOiB1c2VyLm5pY2tuYW1lLCBhdmF0YXJVcmw6IHVzZXIuYXZhdGFyVXJsLCBLVkRhdGFMaXN0OiB1c2VyLktWRGF0YUxpc3QgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zb2xlLmxvZygn5pWw5o2u5YeG5aSH5a6M5q+VIFxcbicsIGFycik7XHJcbiAgICAgICAgLy/liLfmlrDmjpLooYzmppxcclxuICAgICAgICB0aGlzLnVwZGF0ZShhcnIpO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZShhcnIpIHtcclxuICAgICAgICBpZiAoYXJyID09PSB1bmRlZmluZWQpIHJldHVybjtcclxuICAgICAgICB0aGlzLmxpc3QuYXJyYXkgPSBhcnI7XHJcbiAgICAgICAgdGhpcy5saXN0LnJlbmRlckhhbmRsZXIgPSBuZXcgTGF5YS5IYW5kbGVyKHRoaXMsIHRoaXMub25SZW5kZXIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBvblJlbmRlcihjZWxsLCBpbmRleCkge1xyXG4gICAgICAgIC8v6I635Y+W5b2T5YmN5riy5p+T5p2h55uu55qE5pWw5o2uXHJcbiAgICAgICAgdmFyIGRhdGEgPSB0aGlzLmxpc3QuYXJyYXlbaW5kZXhdO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi5Liq5Lq65L+h5oGvXCIsIGRhdGEpO1xyXG4gICAgICAgIHZhciByYW5raW5nID0gY2VsbC5nZXRDaGlsZEJ5TmFtZShcInJhbmtpbmdcIik7XHJcbiAgICAgICAgcmFua2luZy50ZXh0ID0gKGluZGV4ICsgMSk7XHJcbiAgICAgICAgLy/moLnmja7lrZDoioLngrnnmoTlkI3lrZduYW1l77yM6I635Y+W5a2Q6IqC54K55a+56LGh44CCICAgICAgICAgXHJcbiAgICAgICAgdmFyIG5hbWUgPSBjZWxsLmdldENoaWxkQnlOYW1lKFwibmlja05hbWVcIik7XHJcbiAgICAgICAgLy9sYWJlbOa4suafk+WIl+ihqOaWh+acrO+8iOW6j+WPt++8iVxyXG4gICAgICAgIG5hbWUudGV4dCA9IGRhdGEubmlja05hbWU7XHJcbiAgICAgICAgdmFyIGJlc3RTY29yZSA9IGNlbGwuZ2V0Q2hpbGRCeU5hbWUoXCJiZXN0U2NvcmVcIik7XHJcbiAgICAgICAgYmVzdFNjb3JlLnRleHQgPSBkYXRhLktWRGF0YUxpc3RbMF0udmFsdWU7XHJcbiAgICAgICAgLy8gdmFyIGljb25CRyA9IGNlbGwuZ2V0Q2hpbGRCeU5hbWUoXCJpY29uQkdcIik7XHJcbiAgICAgICAgdmFyIGljb24gPSBjZWxsLmdldENoaWxkQnlOYW1lKFwiaWNvblwiKTtcclxuICAgICAgICAvL+WbvueJh+Wkp+Wwj+imgeS4jue8lui+keWZqOWGheS4gOiHtCzlnZDmoIfkuLowMCxcclxuICAgICAgICBpY29uLmxvYWRJbWFnZShkYXRhLmF2YXRhclVybCwgMCwgMCwgNjAsIDYwKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIuaOkuihjOaVsOaNrj1cIiwgaW5kZXgsICc95Yi35paw5a6M5oiQIX5+Jyk7XHJcbiAgICB9XHJcbn0iLCIvKipUaGlzIGNsYXNzIGlzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGJ5IExheWFBaXJJREUsIHBsZWFzZSBkbyBub3QgbWFrZSBhbnkgbW9kaWZpY2F0aW9ucy4gKi9cclxudmFyIENMQVNTJD1MYXlhLmNsYXNzO1xyXG52YXIgU1RBVElDQVRUUiQ9TGF5YS5zdGF0aWM7XG52YXIgVmlldz1sYXlhLnVpLlZpZXc7XHJcbnZhciBEaWFsb2c9bGF5YS51aS5EaWFsb2c7XHJcbnZhciBTY2VuZT1MYXlhLlNjZW5lO1xuaWYoIXdpbmRvdy51aSkgd2luZG93LnVpPXt9O1xudmFyIFJhbmtVST0oZnVuY3Rpb24oX3N1cGVyKXtcclxuXHRcdGZ1bmN0aW9uIFJhbmtVSSgpe1xyXG5cdFx0XHRcclxuXHRcdFx0UmFua1VJLl9fc3VwZXIuY2FsbCh0aGlzKTtcclxuXHRcdH1cclxuXHRcdENMQVNTJChSYW5rVUksJ3VpLlJhbmtVSScsX3N1cGVyKTtcclxuXHRcdHZhciBfX3Byb3RvX189UmFua1VJLnByb3RvdHlwZTtcclxuXHRcdF9fcHJvdG9fXy5jcmVhdGVDaGlsZHJlbj1mdW5jdGlvbigpe1xyXG5cdFx0XHRfc3VwZXIucHJvdG90eXBlLmNyZWF0ZUNoaWxkcmVuLmNhbGwodGhpcyk7XHJcblx0XHRcdHRoaXMuY3JlYXRlVmlldyhSYW5rVUkudWlWaWV3KTtcclxuXHRcdH1cclxuXHRcdFJhbmtVSS51aVZpZXc9e1widHlwZVwiOlwiVmlld1wiLFwicHJvcHNcIjp7XCJ3aWR0aFwiOjYwMCxcImhlaWdodFwiOjYwMH0sXCJjb21wSWRcIjoyLFwiY2hpbGRcIjpbe1widHlwZVwiOlwiTGlzdFwiLFwicHJvcHNcIjp7XCJ3aWR0aFwiOjYwMCxcIm5hbWVcIjpcImxpc3RcIixcImhlaWdodFwiOjQwMH0sXCJjb21wSWRcIjozLFwiY2hpbGRcIjpbe1widHlwZVwiOlwiQm94XCIsXCJwcm9wc1wiOntcIndpZHRoXCI6NjAwLFwicmVuZGVyVHlwZVwiOlwicmVuZGVyXCIsXCJuYW1lXCI6XCJpdGVtXCIsXCJoZWlnaHRcIjo4MH0sXCJjb21wSWRcIjo0LFwiY2hpbGRcIjpbe1widHlwZVwiOlwiSW1hZ2VcIixcInByb3BzXCI6e1wieVwiOjAsXCJ4XCI6MCxcIndpZHRoXCI6NjAwLFwic2tpblwiOlwiaW1nL3BhbmVsQksucG5nXCIsXCJzaXplR3JpZFwiOlwiMjAsMjAsMjAsMjBcIixcIm5hbWVcIjpcImJrXCIsXCJoZWlnaHRcIjo4MH0sXCJjb21wSWRcIjo2fSx7XCJ0eXBlXCI6XCJMYWJlbFwiLFwicHJvcHNcIjp7XCJ5XCI6MTUsXCJ4XCI6NSxcIndpZHRoXCI6NjAsXCJ0ZXh0XCI6XCIwXCIsXCJuYW1lXCI6XCJyYW5raW5nXCIsXCJoZWlnaHRcIjo2MCxcImZvbnRTaXplXCI6NDgsXCJjb2xvclwiOlwiIzAwMDAwMFwiLFwiYm9sZFwiOnRydWUsXCJhbmNob3JZXCI6MCxcImFuY2hvclhcIjowLFwiYWxpZ25cIjpcImNlbnRlclwifSxcImNvbXBJZFwiOjd9LHtcInR5cGVcIjpcIkltYWdlXCIsXCJwcm9wc1wiOntcInlcIjoxMixcInhcIjo2MyxcIndpZHRoXCI6NjAsXCJuYW1lXCI6XCJpY29uXCIsXCJoZWlnaHRcIjo2MH0sXCJjb21wSWRcIjo4fSx7XCJ0eXBlXCI6XCJMYWJlbFwiLFwicHJvcHNcIjp7XCJ5XCI6MjUsXCJ4XCI6MTM1LFwid2lkdGhcIjoyMDAsXCJ0ZXh0XCI6XCJuaWNrTmFtZVwiLFwibmFtZVwiOlwibmlja05hbWVcIixcImhlaWdodFwiOjQwLFwiZm9udFNpemVcIjozMixcImNvbG9yXCI6XCIjMDAwMDAwXCIsXCJhbGlnblwiOlwibGVmdFwifSxcImNvbXBJZFwiOjl9LHtcInR5cGVcIjpcIkxhYmVsXCIsXCJwcm9wc1wiOntcInlcIjoyNSxcInhcIjozNjAsXCJ3aWR0aFwiOjIwMCxcInRleHRcIjpcIjEyMzQ1Njc4OTBcIixcIm5hbWVcIjpcImJlc3RTY29yZVwiLFwiaGVpZ2h0XCI6NDAsXCJmb250U2l6ZVwiOjMyLFwiY29sb3JcIjpcIiMwMDAwMDBcIixcImFuY2hvcllcIjowLFwiYW5jaG9yWFwiOjAsXCJhbGlnblwiOlwibGVmdFwifSxcImNvbXBJZFwiOjEwfV19XX1dLFwibG9hZExpc3RcIjpbXCJpbWcvcGFuZWxCSy5wbmdcIl0sXCJsb2FkTGlzdDNEXCI6W119O1xyXG5cdFx0cmV0dXJuIFJhbmtVSTtcclxuXHR9KShWaWV3KTtcbmV4cG9ydCB7dWkgYXMgZGVmYXVsdH07Il19
